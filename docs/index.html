<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Leaderboard Dashboard</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<style>
body { background:#f8f9fa; padding:40px; }
.card { margin-bottom:12px; border-radius:12px; }
.card-header { cursor:pointer; background:#0d6efd; color:#fff; }
.card-header:hover { background:#0b5ed7; }
.model-row { display:grid; grid-template-columns:2fr 1fr 1fr; text-align:center; }
.tmmlu-table th { background:#198754; color:#fff; }
.general-table th { background:#0dcaf0; color:#000; }
</style>
</head>

<body>

<h1 class="text-center mb-4">ðŸ“Š Leaderboard Dashboard</h1>

<div class="model-row fw-bold mb-2">
  <div>Model</div>
  <div>Overall</div>
  <div>TMMLU+ Overall</div>
</div>

<div class="accordion" id="leaderboard"></div>

<div class="mt-5">
  <h3 class="text-center">TMMLU+ Radar Comparison</h3>
  <div id="radar"></div>
</div>

<script>
fetch("./leaderboard.json")
.then(r => r.json())
.then(data => {

  const container = document.getElementById("leaderboard");
  const traces = [];

  data.leaderboard.forEach((m, i) => {
    const d = data.details[m.model];
    const id = `model-${i}`;

    let tmmluHTML = "";
    Object.entries(d.tmmlu).forEach(([cat, subs], j) => {
      const rows = Object.entries(subs)
        .map(([s,v]) => `<tr><td>${s}</td><td>${v}</td></tr>`).join("");

      tmmluHTML += `
      <div class="card mb-1">
        <div class="card-header" data-bs-toggle="collapse" data-bs-target="#${id}-${j}">
          ${cat}
        </div>
        <div id="${id}-${j}" class="collapse">
          <table class="table table-sm table-striped tmmlu-table">
            <thead><tr><th>Subject</th><th>Score</th></tr></thead>
            <tbody>${rows}</tbody>
          </table>
        </div>
      </div>`;
    });

    const genRows = Object.entries(d.general)
      .map(([k,v]) => `<tr><td>${k}</td><td>${v}</td></tr>`).join("");

    container.innerHTML += `
    <div class="card">
      <div class="card-header model-row" data-bs-toggle="collapse" data-bs-target="#${id}">
        <div>${m.model}</div>
        <div>${m.overall}</div>
        <div>${m.tmmlu_overall ?? "-"}</div>
      </div>
      <div id="${id}" class="collapse">
        <div class="card-body">
          <h6>TMMLU+ Breakdown</h6>
          ${tmmluHTML}
          <h6 class="mt-3">General Benchmarks</h6>
          <table class="table table-sm table-striped general-table">
            <thead><tr><th>Task</th><th>Score</th></tr></thead>
            <tbody>${genRows}</tbody>
          </table>
        </div>
      </div>
    </div>`;

    const labels = Object.keys(d.tmmlu);
    const scores = labels.map(c =>
      Object.values(d.tmmlu[c]).reduce((a,b)=>a+b,0) / Object.values(d.tmmlu[c]).length
    );

    traces.push({
      type:"scatterpolar",
      r:[...scores, scores[0]],
      theta:[...labels, labels[0]],
      name:m.model,
      fill:"toself"
    });
  });

  Plotly.newPlot("radar", traces, {
    polar:{ radialaxis:{ range:[0,1] }},
    legend:{ orientation:"h" }
  });

});
</script>

</body>
</html>
