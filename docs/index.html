<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TMMLU+ Leaderboard</title>

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Plotly -->
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<style>
body { padding:40px; background:#f8f9fa; font-family: Arial, sans-serif; }
.card { border-radius:12px; margin-bottom:12px; }
.card-header { background:#0d6efd; color:white; cursor:pointer; }
.card-header:hover { background:#0b5ed7; }
h2, h4 { text-align: center; }
</style>
</head>
<body>

<h2 class="mb-4">ðŸ“Š TMMLU+ Leaderboard</h2>

<div id="table"></div>
<hr>

<div class="card">
  <div class="card-header" data-bs-toggle="collapse" data-bs-target="#discRadar">
    ðŸ§­ TMMLU+ Discipline Comparison (Radar)
  </div>
  <div class="collapse show" id="discRadar">
    <div class="card-body">
      <div id="radar-discipline"></div>
    </div>
  </div>
</div>

<div class="card">
  <div class="card-header" data-bs-toggle="collapse" data-bs-target="#catRadar">
    ðŸ§­ TMMLU+ Category Comparison (Radar)
  </div>
  <div class="collapse show" id="catRadar">
    <div class="card-body">
      <div id="radar-category"></div>
    </div>
  </div>
</div>

<div class="card">
  <div class="card-header" data-bs-toggle="collapse" data-bs-target="#barCat">
    ðŸ“Š TMMLU+ Category Comparison (Bar)
  </div>
  <div class="collapse show" id="barCat">
    <div class="card-body">
      <div id="bar-category"></div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
// ===== Determine correct path for GitHub Pages =====
const baseURL = window.location.pathname.replace(/\/[^\/]*$/, '/');
// leaderboard.json must be in the same folder as index.html
const jsonPath = baseURL + "leaderboard.json";

// ===== Colors for models =====
const colors = ["#1f77b4","#ff7f0e","#2ca02c","#d62728"];

fetch(jsonPath)
.then(r => r.json())
.then(data => {

  // ===== Table =====
  const table = document.getElementById("table");
  let html = `<table class="table table-striped table-bordered">
<thead class="table-dark"><tr><th>Rank</th><th>Model</th><th>Overall</th><th>TMMLU+</th></tr></thead><tbody>`;
  data.leaderboard.forEach((m,i)=>{
    html += `<tr><td>${i+1}</td><td>${m.model}</td><td>${m.overall}</td><td>${m.tmmlu_overall}</td></tr>`;
  });
  html += "</tbody></table>";
  table.innerHTML = html;

  // ===== Prepare traces =====
  const discTraces = [], catTraces = [], barTraces = [];

  data.leaderboard.forEach((m,i)=>{
    const d = data.details[m.model];
    const color = colors[i % colors.length];

    // Radar - Discipline
    discTraces.push({
      type:"scatterpolar",
      r:Object.values(d.tmmlu_disciplines),
      theta:Object.keys(d.tmmlu_disciplines),
      fill:"toself",
      name:m.model,
      line:{color:color, width:2}
    });

    // Radar - Category
    catTraces.push({
      type:"scatterpolar",
      r:Object.values(d.tmmlu_categories),
      theta:Object.keys(d.tmmlu_categories),
      fill:"toself",
      name:m.model,
      line:{color:color, width:2}
    });

    // Bar - Category
    barTraces.push({
      type:"bar",
      x:Object.keys(d.tmmlu_categories),
      y:Object.values(d.tmmlu_categories),
      name:m.model,
      marker:{color:color}
    });
  });

  // ===== Plot charts =====
  Plotly.newPlot("radar-discipline", discTraces,{
    polar:{radialaxis:{range:[0,1]}},
    legend:{orientation:"h"},
    width:600, height:500
  });

  Plotly.newPlot("radar-category", catTraces,{
    polar:{radialaxis:{range:[0,1]}},
    legend:{orientation:"h"},
    width:600, height:500
  });

  Plotly.newPlot("bar-category", barTraces,{
    barmode:"group",
    yaxis:{range:[0,1]},
    width:800, height:400
  });

})
.catch(e => console.error("Failed to load leaderboard.json:", e));
</script>

</body>
</html>
