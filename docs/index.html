<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>TMMLU+ Leaderboard</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<style>
body { padding:40px; background:#f8f9fa; }
.card { border-radius:12px; margin-bottom:12px; }
.card-header { cursor:pointer; }
</style>
</head>

<body>

<h2 class="text-center mb-4">ðŸ“Š TMMLU+ Leaderboard</h2>

<div id="table"></div>

<hr>

<h4 class="text-center">ðŸ§­ TMMLU+ Category Radar (Average)</h4>
<div id="radar"></div>

<hr>

<h4 class="text-center">ðŸ“š TMMLU+ Detailed Breakdown</h4>
<div id="accordion"></div>

<script>
fetch("leaderboard.json")
.then(r=>r.json())
.then(data=>{

/* ================= TABLE ================= */
let html = `<table class="table table-bordered table-striped">
<thead class="table-dark">
<tr><th>Rank</th><th>Model</th><th>Overall</th><th>TMMLU+</th></tr>
</thead><tbody>`;

data.leaderboard.forEach((m,i)=>{
  html += `<tr><td>${i+1}</td><td>${m.model}</td>
           <td>${m.overall}</td><td>${m.tmmlu_overall}</td></tr>`;
});
html += "</tbody></table>";
document.getElementById("table").innerHTML = html;

/* ================= RADAR ================= */
const colors = ["#1f77b4","#ff7f0e","#2ca02c","#d62728"];
const traces = [];

data.leaderboard.forEach((m,i)=>{
  const tmmlu = data.details[m.model].tmmlu;
  const cats = Object.keys(tmmlu);
  const avgs = [];

  cats.forEach(c=>{
    let sum=0, cnt=0;
    Object.values(tmmlu[c]).forEach(sub=>{
      Object.values(sub).forEach(v=>{ sum+=v; cnt++; });
    });
    avgs.push(cnt ? sum/cnt : 0);
  });

  traces.push({
    type:"scatterpolar",
    r:avgs,
    theta:cats,
    fill:"toself",
    name:m.model,
    line:{color:colors[i%colors.length]}
  });
});

Plotly.newPlot("radar", traces, {
  polar:{radialaxis:{range:[0,1]}},
  legend:{orientation:"h"},
  height:500
});

/* ================= ACCORDION ================= */
let acc = "";
data.leaderboard.forEach((m,mi)=>{
  const tmmlu = data.details[m.model].tmmlu;

  acc += `
  <div class="card">
    <div class="card-header bg-primary text-white" data-bs-toggle="collapse" data-bs-target="#m${mi}">
      ${m.model}
    </div>
    <div id="m${mi}" class="collapse">
      <div class="card-body">`;

  Object.entries(tmmlu).forEach(([cat,subs],ci)=>{
    acc += `
    <div class="card mb-2">
      <div class="card-header bg-secondary text-white"
           data-bs-toggle="collapse"
           data-bs-target="#c${mi}_${ci}">
        ${cat}
      </div>
      <div id="c${mi}_${ci}" class="collapse">
        <div class="card-body">`;

    Object.entries(subs).forEach(([sub,tasks])=>{
      acc += `<h6>${sub}</h6><ul>`;
      Object.entries(tasks).forEach(([k,v])=>{
        acc += `<li>${k}: <b>${v.toFixed(3)}</b></li>`;
      });
      acc += `</ul>`;
    });

    acc += `</div></div></div>`;
  });

  acc += `</div></div></div>`;
});

document.getElementById("accordion").innerHTML = acc;

});
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
